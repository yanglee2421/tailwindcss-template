import{r as w,U as k,a1 as A,a5 as d,H as $,I,O as T,R as x,P as N}from"./runtime-core.esm-bundler-a475101a.js";import{H as C,bm as S,a3 as _,a4 as B,K as f,x as P,aj as O,y as c,J as p}from"./index-8ab77898.js";function V(t){let e;const l=C("loading"),a=w(!1),n=k({...t,originalPosition:"",originalOverflow:"",visible:!1});function s(r){n.text=r}function i(){const r=n.parent;if(!r.vLoadingAddClassList){let o=r.getAttribute("loading-number");o=Number.parseInt(o)-1,o?r.setAttribute("loading-number",o.toString()):(f(r,l.bm("parent","relative")),r.removeAttribute("loading-number")),f(r,l.bm("parent","hidden"))}m(),b.unmount()}function m(){var r,o;(o=(r=u.$el)==null?void 0:r.parentNode)==null||o.removeChild(u.$el)}function L(){var r;t.beforeClose&&!t.beforeClose()||(a.value=!0,clearTimeout(e),e=window.setTimeout(g,400),n.visible=!1,(r=t.closed)==null||r.call(t))}function g(){if(!a.value)return;const r=n.parent;a.value=!1,r.vLoadingAddClassList=void 0,i()}const b=S({name:"ElLoading",setup(){return()=>{const r=n.spinner||n.svg,o=d("svg",{class:"circular",viewBox:n.svgViewBox?n.svgViewBox:"0 0 50 50",...r?{innerHTML:r}:{}},[d("circle",{class:"path",cx:"25",cy:"25",r:"20",fill:"none"})]),h=n.text?d("p",{class:l.b("text")},[n.text]):void 0;return d(B,{name:l.b("fade"),onAfterLeave:g},{default:$(()=>[I(T("div",{style:{backgroundColor:n.background||""},class:[l.b("mask"),n.customClass,n.fullscreen?"is-fullscreen":""]},[d("div",{class:l.b("spinner")},[o,h])]),[[_,n.visible]])])})}}}),u=b.mount(document.createElement("div"));return{...A(n),setText:s,removeElLoadingChild:m,close:L,handleAfterLeave:g,vm:u,get $el(){return u.$el}}}let v;const q=function(t={}){if(!P)return;const e=E(t);if(e.fullscreen&&v)return v;const l=V({...e,closed:()=>{var n;(n=e.closed)==null||n.call(e),e.fullscreen&&(v=void 0)}});R(e,e.parent,l),y(e,e.parent,l),e.parent.vLoadingAddClassList=()=>y(e,e.parent,l);let a=e.parent.getAttribute("loading-number");return a?a=`${Number.parseInt(a)+1}`:a="1",e.parent.setAttribute("loading-number",a),e.parent.appendChild(l.$el),x(()=>l.visible.value=e.visible),e.fullscreen&&(v=l),l},E=t=>{var e,l,a,n;let s;return N(t.target)?s=(e=document.querySelector(t.target))!=null?e:document.body:s=t.target||document.body,{parent:s===document.body||t.body?document.body:s,background:t.background||"",svg:t.svg||"",svgViewBox:t.svgViewBox||"",spinner:t.spinner||!1,text:t.text||"",fullscreen:s===document.body&&((l=t.fullscreen)!=null?l:!0),lock:(a=t.lock)!=null?a:!1,customClass:t.customClass||"",visible:(n=t.visible)!=null?n:!0,target:s}},R=async(t,e,l)=>{const{nextZIndex:a}=O(),n={};if(t.fullscreen)l.originalPosition.value=c(document.body,"position"),l.originalOverflow.value=c(document.body,"overflow"),n.zIndex=a();else if(t.parent===document.body){l.originalPosition.value=c(document.body,"position"),await x();for(const s of["top","left"]){const i=s==="top"?"scrollTop":"scrollLeft";n[s]=`${t.target.getBoundingClientRect()[s]+document.body[i]+document.documentElement[i]-Number.parseInt(c(document.body,`margin-${s}`),10)}px`}for(const s of["height","width"])n[s]=`${t.target.getBoundingClientRect()[s]}px`}else l.originalPosition.value=c(e,"position");for(const[s,i]of Object.entries(n))l.$el.style[s]=i},y=(t,e,l)=>{const a=C("loading");["absolute","fixed","sticky"].includes(l.originalPosition.value)?f(e,a.bm("parent","relative")):p(e,a.bm("parent","relative")),t.fullscreen&&t.lock?p(e,a.bm("parent","hidden")):f(e,a.bm("parent","hidden"))};export{q as L};
