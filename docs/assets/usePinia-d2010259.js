import{bn as te,bo as ne,bl as oe}from"./index-76e44084.js";import{ad as J,r as N,ac as R,w as re,V as T,m as O,aD as U,a5 as se,aA as ce,p as ae,S as ie,g as ue,k as le,a2 as fe,f as F}from"./runtime-core.esm-bundler-780f1e82.js";var me=!1;let W;const j=e=>W=e,$=Symbol();function A(e){return e&&typeof e=="object"&&Object.prototype.toString.call(e)==="[object Object]"&&typeof e.toJSON!="function"}var I;(function(e){e.direct="direct",e.patchObject="patch object",e.patchFunction="patch function"})(I||(I={}));function Le(){const e=J(!0),o=e.run(()=>N({}));let n=[],t=[];const s=R({install(r){j(s),s._a=r,r.provide($,s),r.config.globalProperties.$pinia=s,t.forEach(c=>n.push(c)),t=[]},use(r){return!this._a&&!me?t.push(r):n.push(r),this},_p:n,_a:null,_e:e,_s:new Map,state:o});return s}const q=()=>{};function B(e,o,n,t=q){e.push(o);const s=()=>{const r=e.indexOf(o);r>-1&&(e.splice(r,1),t())};return!n&&ce()&&ae(s),s}function E(e,...o){e.slice().forEach(n=>{n(...o)})}function V(e,o){e instanceof Map&&o instanceof Map&&o.forEach((n,t)=>e.set(t,n)),e instanceof Set&&o instanceof Set&&o.forEach(e.add,e);for(const n in o){if(!o.hasOwnProperty(n))continue;const t=o[n],s=e[n];A(s)&&A(t)&&e.hasOwnProperty(n)&&!O(t)&&!U(t)?e[n]=V(s,t):e[n]=t}return e}const he=Symbol();function de(e){return!A(e)||!e.hasOwnProperty(he)}const{assign:S}=Object;function pe(e){return!!(O(e)&&e.effect)}function _e(e,o,n,t){const{state:s,actions:r,getters:c}=o,f=n.state.value[e];let m;function a(){f||(n.state.value[e]=s?s():{});const u=fe(n.state.value[e]);return S(u,r,Object.keys(c||{}).reduce((h,_)=>(h[_]=R(F(()=>{j(n);const b=n._s.get(e);return c[_].call(b,b)})),h),{}))}return m=M(e,a,o,n,t,!0),m.$reset=function(){const h=s?s():{};this.$patch(_=>{S(_,h)})},m}function M(e,o,n={},t,s,r){let c;const f=S({actions:{}},n),m={deep:!0};let a,u,h=R([]),_=R([]),b;const y=t.state.value[e];!r&&!y&&(t.state.value[e]={}),N({});let C;function x(l){let i;a=u=!1,typeof l=="function"?(l(t.state.value[e]),i={type:I.patchFunction,storeId:e,events:b}):(V(t.state.value[e],l),i={type:I.patchObject,payload:l,storeId:e,events:b});const v=C=Symbol();ie().then(()=>{C===v&&(a=!0)}),u=!0,E(h,i,t.state.value[e])}const Q=q;function X(){c.stop(),h=[],_=[],t._s.delete(e)}function Y(l,i){return function(){j(t);const v=Array.from(arguments),L=[],k=[];function G(d){L.push(d)}function ee(d){k.push(d)}E(_,{args:v,name:l,store:p,after:G,onError:ee});let P;try{P=i.apply(this&&this.$id===e?this:p,v)}catch(d){throw E(k,d),d}return P instanceof Promise?P.then(d=>(E(L,d),d)).catch(d=>(E(k,d),Promise.reject(d))):(E(L,P),P)}}const Z={_p:t,$id:e,$onAction:B.bind(null,_),$patch:x,$reset:Q,$subscribe(l,i={}){const v=B(h,l,i.detached,()=>L()),L=c.run(()=>re(()=>t.state.value[e],k=>{(i.flush==="sync"?u:a)&&l({storeId:e,type:I.direct,events:b},k)},S({},m,i)));return v},$dispose:X},p=T(Z);t._s.set(e,p);const w=t._e.run(()=>(c=J(),c.run(()=>o())));for(const l in w){const i=w[l];if(O(i)&&!pe(i)||U(i))r||(y&&de(i)&&(O(i)?i.value=y[l]:V(i,y[l])),t.state.value[e][l]=i);else if(typeof i=="function"){const v=Y(l,i);w[l]=v,f.actions[l]=i}}return S(p,w),S(se(p),w),Object.defineProperty(p,"$state",{get:()=>t.state.value[e],set:l=>{x(i=>{S(i,l)})}}),t._p.forEach(l=>{S(p,c.run(()=>l({store:p,app:t._a,pinia:t,options:f})))}),y&&r&&n.hydrate&&n.hydrate(p.$state,y),a=!0,u=!0,p}function z(e,o,n){let t,s;const r=typeof o=="function";typeof e=="string"?(t=e,s=r?n:o):(s=e,t=e.id);function c(f,m){const a=ue();return f=f||a&&le($,null),f&&j(f),f=W,f._s.has(t)||(r?M(t,o,s,f):_e(t,s,f)),f._s.get(t)}return c.$id=t,c}const ve="modulepreload",ge=function(e){return"/vite-vue/"+e},H={},g=function(o,n,t){if(!n||n.length===0)return o();const s=document.getElementsByTagName("link");return Promise.all(n.map(r=>{if(r=ge(r),r in H)return;H[r]=!0;const c=r.endsWith(".css"),f=c?'[rel="stylesheet"]':"";if(!!t)for(let u=s.length-1;u>=0;u--){const h=s[u];if(h.href===r&&(!c||h.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${r}"]${f}`))return;const a=document.createElement("link");if(a.rel=c?"stylesheet":ve,c||(a.as="script",a.crossOrigin=""),a.href=r,document.head.appendChild(a),c)return new Promise((u,h)=>{a.addEventListener("load",u),a.addEventListener("error",()=>h(new Error(`Unable to preload CSS for ${r}`)))})})).then(()=>o())},Se=["/login"],be=[{path:"/:pathMatch(.*)*",redirect:"/404"},{path:"/login",component:()=>g(()=>import("./login-728c36ce.js"),["assets/login-728c36ce.js","assets/index-76e44084.js","assets/runtime-core.esm-bundler-780f1e82.js","assets/_plugin-vue_export-helper-c27b6911.js","assets/login-5fd1914f.css"]),name:"login",meta:{title:"登录"},beforeEnter(e,o){if(K().isLogined)return{name:"home",replace:!0}}},{path:"",component:()=>g(()=>import("./layout-155acf29.js"),["assets/layout-155acf29.js","assets/index-76e44084.js","assets/runtime-core.esm-bundler-780f1e82.js","assets/useResize-64aa6ff8.js","assets/_plugin-vue_export-helper-c27b6911.js","assets/layout-7d09fc49.css","assets/v-vis-9108e756.css"]),children:[{path:"",component:()=>g(()=>import("./home-a8711c08.js"),["assets/home-a8711c08.js","assets/runtime-core.esm-bundler-780f1e82.js","assets/_plugin-vue_export-helper-c27b6911.js","assets/index-76e44084.js","assets/home-00ff7a2b.css"]),name:"home",meta:{title:"首页"}},{path:"404",component:()=>g(()=>import("./404-585f285b.js"),["assets/404-585f285b.js","assets/index-76e44084.js","assets/runtime-core.esm-bundler-780f1e82.js","assets/service-2e1af24a.js"]),name:"404",meta:{title:"404，找不到你要的了"}},{path:"table",component:()=>g(()=>import("./table-93f2b7b3.js"),["assets/table-93f2b7b3.js","assets/_plugin-vue_export-helper-c27b6911.js","assets/runtime-core.esm-bundler-780f1e82.js"]),name:"table",meta:{title:"表格"}},{path:"particle",component:()=>g(()=>import("./particle-239ff0a7.js"),["assets/particle-239ff0a7.js","assets/class-snow-3a5ffbb7.js","assets/useResize-64aa6ff8.js","assets/runtime-core.esm-bundler-780f1e82.js","assets/_plugin-vue_export-helper-c27b6911.js","assets/particle-3965ee2b.css","assets/v-vis-9108e756.css"]),name:"particle",meta:{title:"粒子动画"}},{path:"snow",component:()=>g(()=>import("./snow-16e13080.js"),["assets/snow-16e13080.js","assets/useResize-64aa6ff8.js","assets/runtime-core.esm-bundler-780f1e82.js","assets/class-snow-3a5ffbb7.js","assets/_plugin-vue_export-helper-c27b6911.js","assets/snow-d9114ae6.css","assets/v-vis-9108e756.css"]),name:"snow",meta:{title:"雪飘"}}]},{path:"/demo",component:()=>g(()=>import("./demo-ad059695.js"),["assets/demo-ad059695.js","assets/useResize-64aa6ff8.js","assets/runtime-core.esm-bundler-780f1e82.js","assets/class-snow-3a5ffbb7.js","assets/_plugin-vue_export-helper-c27b6911.js","assets/demo-415cd370.css","assets/v-vis-9108e756.css"]),name:"demo",meta:{title:"demo"}}],ye=te("/vite-vue/"),D=ne({history:ye,routes:be});D.beforeEach((e,o)=>{const n=K();if(!Se.includes(e.path)&&!n.isLogined)return{name:"login"}});D.afterEach((e,o)=>{const n=e.meta.title;typeof n=="string"&&(document.title=n)});const K=z("auth",()=>{const e=T({isLogined:!1,user:"",token:"",invalidTime:0}),o=()=>{Object.assign(e,{isLogined:!1,user:"",token:"",invalidTime:0}),D.replace({name:"login"}),clearTimeout(n),localStorage.removeItem("auth"),localStorage.removeItem("token")};let n=0;const t=(c,f=!1)=>{const{user:m,invalidTime:a,token:u}=c;Object.assign(e,{user:m,invalidTime:a,token:u,isLogined:!0}),D.replace({name:"home"}),clearTimeout(n),n=setTimeout(o,a-Date.now()),f&&(localStorage.setItem("auth",JSON.stringify(e)),localStorage.setItem("token",u))},s=()=>{try{const c=localStorage.getItem("auth");if(!c)return!1;const f=JSON.parse(c),{user:m,token:a,invalidTime:u}=f;if(!m||!a||!u)throw new Error;if(typeof m!="string")throw new Error;if(typeof a!="string")throw new Error;if(typeof u!="number")throw new Error;if(u-Date.now()<1e3*60*5)throw new Error;return t({user:m,token:a,invalidTime:u}),!0}catch(c){console.error(c),localStorage.removeItem("auth"),localStorage.removeItem("token"),oe.warning("登录信息已失效")}return!1};return{isLogined:F(()=>e.isLogined||s()),state:e,actLogin:t,actSignUp:o}}),ke=z("demoState",()=>{const e=T({isDark:!1,currentUser:"",currentPage:"",userPermission:[]});return{state:e,actIsDark:n=>{const t=document.documentElement.classList;e.isDark=n,e.isDark?t.add("dark"):t.remove("dark")}}});export{K as a,Le as c,D as r,ke as u};
